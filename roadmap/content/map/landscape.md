# Документация: взаимодействие ландшафта, юнитов и игровой механики

---

## 1. Базовый объект ландшафта

### Концепция

- Каждая клетка ландшафта динамически реагирует на внешние воздействия (строительство, разрушение, добыча)
- Рельеф (перепады высот) и тип местности влияют на игровой процесс:
    - Высоты дают тактические преимущества (например, увеличение дальности стрельбы)
    - Тип местности определяет доступные действия (рубка леса, добыча камня)
- Смена времён года и эпох глобально меняет свойства клеток (текстуры, доступность, экономическую эффективность)
- Наличие или отсутствие временных объектов не меняет базовый тип клетки. Например, равнина с лесом, после его вырубки, останется равниной. 
- Непосредственного взаимодействия между клетками не предусмотрено. Паттерны преобразования ландшафта должны быть прописаны в механиках действий юнита. Например, при осушении болота диаметром в шесть клеток, будет уменьшаться диаметр круга. "Выедания" кусков болота происходить не будет. 
- Каждый тип клетки может изменить свой тип или состояние под воздействием климата. 

#### Предполагаемая реализация

- **Состояние клетки:**
    - Хранит: тип (лес, болото, скалы, дорога), высоту (0-100), список доступных ресурсов, модификаторы.
    - Изменение состояния происходит через накопление «единиц воздействия» (аналог HP)
- **Механика перепадов высот:**
    - Диапазоны высот привязаны к текстурам и эффектам (см. Пример)
- **Смена сезонов:**
    - Таймер активирует глобальные изменения:
        - Зима: водоёмы замерзают, позволяя перемещение по льду
        - Весна: +30% к эффективности сельхоззон
- **Климатические изменения:**
  - Изменение влажности
    - Появление новых временных объектов: ручьи, заболоченность
    - Исчезновение временных объектов: пересыхание болот, гибель леса
    - Изменение типа клетки: с равнинного на пустынный
  - Изменение температуры:
    - Изменение типа клетки: с равнинного на пустынный или арктический
    - Затрагивает модификаторы урожайности
    - Меняет паттерны поведения животных
#### Пример: таблица высот

| Диапазон | Текстура | Эффект                  |  
|----------|----------|-------------------------|  
| 0-15     | Равнина  | Скорость юнитов +10%    |  
| 16-40    | Холмы    | Дальность стрельбы +15% |  
| 41-100   | Горы     | Непроходимо для пехоты  |  

### Связанные задачи

#### Звук

1. Создание звуковых эффектов для изменения состояния клеток (строительство, разрушение)

#### Графика

1. Отрисовка текстур для всех типов местности (лес, болото, дороги)
2. Анимация сезонных изменений (снегопад, таяние льда)

#### Гейм-дизайн

1. Балансировка модификаторов высот (таблица эффектов)
2. Настройка длительности сезонных циклов

#### Программирование

1. Реализация системы хранения состояния клетки (тип, высота, ресурсы)
2. Разработка механики накопления "единиц воздействия"

#### UI/UX

1. Создание иконок для отображения типа клетки в интерфейсе

---

## 2. Взаимодействие юнитов и ландшафта

### Концепция

- Юниты получают данные о клетках для планирования действий (строительство, добыча, перемещение)
- Для преобразования ландшафта требуется накопление «единиц воздействия»:
    - Разные типы местности имеют уникальные требования (например, болото требует осушения)

#### Предполагаемая реализация

- **Экономическая активность:**
    - Строительство дороги: 10 ед. воздействия на клетку.
    - Осушение болота: 10 ед. воздействия + 5 ед. на водоотведение.
- **Климатические ограничения:**
    - При наличии временного объекта типа **болото** строительство невозможно до его осушения.
    - Снегопад блокирует строительство в горах.

### Связанные задачи

#### Звук
 
1. Озвучка действий юнитов (рубка леса, осушение болот)

#### Графика

1. Визуальные эффекты преобразования ландшафта (появление дорог, осушение)

#### Гейм-дизайн

1. Определение требований для преобразования разных типов местности
2. Балансировка стоимости "единиц воздействия"

#### Программирование

1. Реализация проверки доступных действий для клетки
2. Механика осушения болот (+ дополнительные затраты)

#### UI/UX
1. Подсказки при наведении на клетку (доступные и недоступные действия, затраты)
---

## 3. Поиск пути

### Концепция
- Маршруты строятся с учётом проходимости, модификаторов скорости и препятствий.
- Искусственные объекты (дороги, ЖД) влияют на приоритет путей

#### Предполагаемая реализация

- **Алгоритм поиска:**
    1. Игрок выбирает конечную точку (правый клик).
    2. Система анализирует прямые маршруты на наличие препятствий.
    3. Для проходимых маршрутов рассчитывается время движения:  
       `Время = Σ(1 / (Базовая скорость юнита × Модификатор клетки))`
    4. Маршрут с минимальным временем выбирается автоматически
- **Особенности:**
    - Железные дороги: замедляют пеших юнитов, но ускоряют поезда
    - «Пробки»: при пересечении маршрутов система предлагает альтернативные пути

#### Пример: модификаторы скорости

| Тип клетки      | Модификатор |  
|-----------------|-------------|  
| Дорога          | ×2.0        |  
| Лес             | ×0.5        |  
| Болото          | ×0.3        |  
| Железная дорога | ×0.0 (блок) |  

---
### Связанные задачи

#### Звук
1. Озвучка перемещения юнитов

#### Графика

1. Визуализация выбранного маршрута (подсветка пути)

#### Гейм-дизайн

1. Тестирование и балансировка модификаторов скорости

#### Программирование
1. Реализация алгоритма поиска пути с учётом модификаторов.
2. Механика перенаправления при "пробках"

#### UI/UX

1. Отображение времени движения и альтернативных маршрутов

## 4. Генерация карты

### Концепция
- Уникальность карты обеспечивается seed-значением и процедурной генерацией
- Смена эпох перераспределяет точки интереса (ресурсы, сюжетные объекты)

#### Предполагаемая реализация

- **Seed-генерация:**
    - Контрольная сумма = Σ(Количество ресурсов × их ценность)
    - Ресурсы распределяются пропорционально балансу экономики
- **Смена эпох:**
    - 30% ресурсных зон перемещаются.
    - Добавляются уникальные объекты (например, руины древних цивилизаций)
    - 
### Связанные задачи

#### Звук
1. Фоновая музыка для разных типов биомов

#### Графика
1. Отрисовка уникальных сюжетных объектов для эпох

#### Гейм-дизайн

1. Создание таблицы ценности ресурсов для контрольной суммы

#### Программирование

1. Разработка процедурной генерации на основе seed-значений
2. Реализация смены ресурсных зон между эпохами

#### UI/UX

1. Интерактивная мини-карта с фильтрами по типам ресурсов

---

## 5. Динамические изменения ландшафта

### Концепция

- Временные объекты (лес, болото, ресурсы) могут быть удалены или преобразованы
- Строительство зданий требует предварительной подготовки территории

#### Предполагаемая реализация

- **Расчистка территории:**
    - Прочность временного объекта = 100 ед.
    - Группа из N рабочих тратит: `100 / (N × Сила_инструмента)` минут.
    - После расчистки клетка принимает тип большинства соседних.
- **Снос зданий:**
    - Мгновенное удаление через интерфейс строения.
    - После анимации (3 сек) клетка становится доступной для новых действий.

### Связанные задачи

#### Звук
1. Звуковые эффекты разрушения/восстановления объектов

#### Графика

1. Анимация постепенной расчистки леса/скал

#### Гейм-дизайн

1. Определение времени расчистки для разных типов объектов

#### Программирование

1. Реализация таймеров для анимации изменений
2. Механика анализа соседей для определения типа клетки

#### UI/UX

1. Прогресс-бар для отображения процесса расчистки
---

## 6. Военное взаимодействие

### Концепция
- Погода и рельеф напрямую влияют на боевые возможности юнитов
- Ландшафт можно модифицировать для тактических преимуществ (окопы, ловушки)

#### Предполагаемая реализация

- **Погодные эффекты:**
    - Дождь: -20% к дальности стрельбы
    - Метель: -30% к скорости перемещения, обморожение юнитов без экипировки
- **Укрепления:**
    - Создание окопа: 15 ед. воздействия, +30% к защите
    - Ловушки: замедляют врагов на 50% в радиусе 3 клеток
    - 
### Связанные задачи

#### Звук
1. Звуки погодных эффектов (дождь, метель, гром)

#### Графика

1. Отрисовка воронок от взрывов и укреплений

#### Гейм-дизайн
1. Балансировка значений защиты для укреплений

#### Программирование

1. Реализация системы погодных модификаторов
2. Механика создания/разрушения ловушек

#### UI/UX
1. Индикаторы статуса юнитов в укреплениях

---

## 7. Экономика и ресурсы

### Концепция

- Ресурсы добываются вручную или через автоматизированные здания
- Добывающие здания увеличивают эффективность, но замедляют истощение ресурсов

#### Предполагаемая реализация

- **Ручная добыча:**
    - Ресурс исчезает при достижении 0 ед. прочности
    - Скорость добычи = Сила_юнита × Модификатор_инструмента
- **Автоматизация:**
    - Лесопилка: +50% к скорости добычи, ресурс истощается в 2 раза медленнее
    - Шахта: требует предварительной расчистки скал

### Связанные задачи

#### Звук

1. Звуковые уведомления об истощении ресурсов

#### Графика
1. Анимация работы добывающих зданий

#### Гейм-дизайн
1. Балансировка коэффициента N для автоматизации

#### Программирование

1. Реализация системы истощения ресурсов
2. Механика работы лесопилки/шахты

#### UI/UX

1. Панель управления ресурсами с прогнозами добычи


---

## 8. Климатические и эпохальные изменения

### Концепция

- Климат влияет на доступность действий и скорость строительства
- Переход в новую эпоху меняет ландшафтные паттерны и точки интереса

#### Предполагаемая реализация

- **Климатические ограничения:**
    - Строительство на болотах: заблокировано до осушения
    - Замерзание рек: позволяет перемещение юнитов зимой
- **Смена эпох:**
    - Генерация новых ресурсных зон в ранее пустых регионах
    - Появление уникальных объектов (например, обсерваторий в эпоху Просвещения)
### Связанные задачи

#### Звук

1. Уникальные звуковые темы для каждой эпохи

#### Графика

1. Визуальные маркеры климатических ограничений

#### Гейм-дизайн

1. Проектирование таблицы влияния климата на геймплей
2. Создание схемы изменений каждого типа клеток, с учётом наличия или отсутствия временных объектов, при смене времён года

#### Программирование

1. Реализация глобального таймера сезонов/эпох
2. Механика блокировки строительства на болотах

#### UI/UX

1. Календарь сезонов с подсказками об эффектах  
