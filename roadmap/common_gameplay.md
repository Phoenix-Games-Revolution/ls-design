# Общий процесс разработки 

Предполагается, что игра будет разрабатываться на на C++. Следовательно, большую роль будет играть механизм наследования. 

На первом этапе нужно будет продумать и реализовать следующие моменты:

1. Единый объект окружающей среды, который должен включать все методы, вызов которых будет включать взаимодействие между юнитами(экономическими и военными) и средой, вызывать нужные анимации, замену моделей среды как реакцию на воздействие. 
2. От этого объекта наследуются классы различных экосистем с собственными методами, в перспективе подземные, подводные и космические среды обитания. 
3. Создание графического макета/полигона для базового тестирования игровых механик. 3-D полигон с модельками с минимальными формами и без текстур на которых будет проверяться работа различных механик. Например, модель юнита банально должна ходить по поверхности при вызове соответствующего метода.
4. Создание генеративного движка, который будет генерировать карты. Тестирование должно проводиться на макете. 
5. Разработка глобального объекта юнит от которого будут наследоваться классы юнитов с определённым набором методов.
7. Последовательное тестирование взаимодействия механик юнитов, строений и среды. 

## Выстраивание среды и уровней взаимодействия с игроком

Базовый объект ландшафта должен:

1. Реагировать на внешнее воздействие (как игрока, так и компьютерного оппонента), заменяя текстуру в зависимости от типа взаимодействия (разрушение, постройка, добыча). 
2. Хранить внешние объекты, которые будут отрисовываться при генерации карты. Предполагается, что наземный ландшафт будет хранить следующие типы объектов: лесистая местность, болотистая местность, пески, скалы, ресурсы, разные текстуры дорог, железная дорога. 
3. Поддерживать три основных типа взаимодействия: добавление, убавление, разрушение. Добавление - процесс замены текстуры на искусственное сооружение при инициации юнитом действия данного типа. Пример - строитель подходит в определённую точку ландшафта и запускает процесс строительства дороги. Ландшафт отвечает появлением текстуры дороги. 
4. Ландшафт должен хранить данные о состоянии своей минимальной единицы. В общем, нужно реализовать логику игры "Сапёр". Клетке (или другой минимальной единице ландшафта) будет присвоено состояние. При инициации действия со стороны юнита запрашивается статус клетки. 
5. Реализация сложного рельефа может быть осуществлена с помощью таблицы перепадов высот. На каждый диапазон значений - своя текстура. Этот диапазон значений будет учитываться в состоянии клетки. Юниты будут получать эти значения при запросе статуса клетки и получать дополнительные преимущества или ослабления в зависимости от показателей. Геймплейно это будет выражаться в таких деталях как увеличение дальности стрельбы лучников, находящихся на возвышенности.
6. Хранение данных о сумме воздействий и условиях, которые необходимы, чтобы инициировать изменение текстуры и свойств ландшафта. Чтобы возделать поле, крестьянин должен потратить N единиц воздействия (аналог урона для боевых юнитов), для того, чтобы сделать то же самое в болотистой местности  ему потребуется N единиц воздействия + затраты на водоотведение. 
7. Ландшафт должен хранить данные о наличии объектов доступных для взаимодействия. Если клетка хранит лесной массив, значит юнит может инициировать процесс рубки леса, но не добычи камня, но не наоборот. 
8. Генерация карты должна строиться на основе контрольной суммы, которая будет высчитываться путём подсчёта единиц воздействия для достижения экономического эффекта. Под последним понимаются все ресурсы, которые попадают в экономику и являются классами объекта ресурс.
9. Базовая смена времён года по таймеру. Смена текстур, включение глобальных эффектов влияющих на экономику и местность. Например, ограниченное перемерзание водоёмов делает возможным перемещение юнитов по льду. После весны повышается эффективность селскохозяйственных зон.

### Взаимодействие среды и экономической деятельности юнитов и построек

Взаимодействие между объектом юнит и объектом ландшафт строится на получении данных от последнего. На этом будут построена система поиска пути. 

Поиск пути строится примерно на таких принципах:

1. Инициация прокладки маршрута. Для активного юнита назначается конечная точка маршрута(клик правой кнопкой мыши на конечной точке). 
2. Получение данных ландшафта. Каждая прямая полоса от точки начала маршрута до конечной точки - массив данных с типами участка.
3. Если в массиве встречается непроходимый участок, массив исключается из перечня маршрутов.
4. По оставшимся высчитывается скорость: скорость юнита (с учётом модификаторов) складывается по тайлам, которые предстоит пройти. Маршрут с наименьшим значением получает приоритет. 
5. Тайлы с проложенной железной дорогой считаются непроходимыми для юнитов. 
6. Тайлы с дорогой дают значительный модификатор скорости для юнитов и получают приоритет по умолчанию. 
7. Маршрут это итерация скорости юнита от стартовой до финишной точки. 

#### Удаление временных элементов ландшафта, снос построек

1. Для придания игровому процессу динамики, удаление зданий будет происходить мгновенно, через интерфейс самого строения. Прежде занятые тайлы ландшафта после периода анимации вновь получают статус свободных для взаимодействия. 
2. Расчистка временных объектов ландшафта: болота, леса, скалы. Механика процесса: значение прочности уменьшается на величину совокупного модификатора урона рабочих. После исчерпания прочности тайл заменяется ландшафтом того же типа, что и пять окружающих.
3. При строительстве сооружений на занятых временными объектами территориях, время постройки здания увеличивается на время, которое понадобится на расчистку территории тем количеством юнитов, которые осуществляют строительство. По завершении работ, тайлы с временными объектами заменяются строением.

#### Строительство добывающих зданий на месте временного объекта типа ресурс

1. По мере ручной добычи какого-либо ресурса он исчезает со скоростью равной скорости расчистки ландшафта. Количество доступного ресурса равно прочности временного объекта типа ресурс.
2. При строительстве специальных добывающих зданий: лесопилка, каменный карьер, шахта - количество доступного ресурса увеличивается в N раз, понятнее будет после моделирования экономики. Скорость изменения ландшафта также падает.
3. Смена текстур с переходом в новую эпоху. 
4. Климатические особенности влияют на скорость и возможность строительства. Например, при наличии временного объекта типа болото - строительство невозможно.

### Взаимодействие среды и военных юнитов и построек

1. Погодные условия влияют на скорость передвижения юнитов. В зависимости от сезона, части карты становятся либо доступными, либо недоступными для перемещения. 
2. Должна быть реализована возможность расчистки лесных зон военными юнитами.
3. Единицы, которые наносят тяжелый урон и попадают по тайлу ландшафта, должны инициировать появление текстур, меняющих последний. Например, воронки.
4. Тип временного объекта под военные нужды - окоп, люнет и иные виды укреплений. Военный юнит инициирует появление таких объектов, доступных для взаимодействия, должна быть проработана анимация занятия укрепления. Юниты в укреплениях получают модификатор к обороне.
